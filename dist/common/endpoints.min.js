require("underscore");var utils=function(a){var b={};return b.param=function(a){var b="";for(var c in a)""!==b&&(b+="&"),b+=c+"="+a[c];return b},b.deepExtend=function(){var c=Array.prototype.slice.call(arguments,0),d=c.shift();return a.each(c,function(a){b.deepMerge(d,a)}),d},b.deepMerge=function(c,d){return a.each(d,function(d,e){var f=c[e]||{},g=a.isObject(d),h=a.isArray(d);g||h?(g&&!a.isObject(d)&&(c[e]={}),h&&!a.isArray(d)&&(c[e]=[]),c[e]=b.deepMerge(f,d)):c[e]=d}),c},b.decorate=function(b,c,d){var e=b[c]||function(){};"function"==typeof e&&(b[c]=a.wrap(e,d))},b}(underscore),resource=function(a,b){var c=function(a,b,c,d){this.decorators=c,this.defaults=b,this.ajax=a;for(var e in d)this[e]=this._create(d[e])};return c.prototype._create=function(c){return a.bind(function(d,e){var f=a.extend({},this.defaults);f.url+=c.path,f.type=c.type,d=a.extend(f,d),c.before&&c.before(d);for(var g in this.decorators)b.decorate(d,g,this.decorators[g]);return this["_"+c.type](d),e?d:this.ajax(d)},this)},c.prototype._GET=function(a){a.data&&(a.url+="?"+b.param(a.data),delete a.data)},c.prototype._POST=function(a){a.data&&(a.data=JSON.stringify(a.data))},c.prototype._DELETE=function(a){a.data&&(a.url+="?"+b.param(a.data),delete a.data)},c}(underscore,utils),endpoints=function(a,b){var c={dataType:"json",timeout:5e3,headers:{}};c.headers={"Content-Type":"application/json"};var d=function(d,e){var f=e.decorators||{},g=e.resources;delete e.decorators,delete e.resources,this.resourceDefaults=a.deepExtend({},c,e);for(var h in g)this[h]=new b(d,this.resourceDefaults,f,g[h])};return d.prototype.configure=function(b){a.deepMerge(this.resourceDefaults,b)},d}(utils,resource);module.exports=endpoints;