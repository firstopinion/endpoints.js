require("underscore");var utils={handler:function(a,b,c){return function(){return"[object Array]"!==Object.prototype.toString.call(b)?a.apply(b,arguments):a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}},param:function(a){var b="";for(var c in a)""!==b&&(b+="&"),b+=c+"="+a[c];return b}},resource=function(a,b){var c=function(a,b,c){for(var d in a)this[d]=this._create(a[d]);this.defaults=b,this.ajax=c};return c.prototype._create=function(b){return utils.handler(function(c,d){var e=a.extend({},this.defaults);return e.url+=b.path,e.type=b.type,c=a.extend(e,c),b.before&&b.before(c),this["_"+b.type](c),d?c:this.ajax(c)},this)},c.prototype._GET=function(a){a.data&&(a.url+="?"+b.param(a.data),delete a.data)},c.prototype._POST=function(a){a.data&&(a.data=JSON.stringify(a.data))},c.prototype._DELETE=function(a){a.data&&(a.url+="?"+b.param(a.data),delete a.data)},c}(underscore,utils),endpoints=function(a){var b=function(b,c){for(var d in c.resources)this[d]=new a(c.resources[d],c,b);delete c.resources,this.defaults=c};return b}(resource);module.exports=endpoints;