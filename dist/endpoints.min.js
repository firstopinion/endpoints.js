!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.Endpoints=b()}(this,function(){var a,b,c,d,e,f,g,h;return a=function(){var a={};return a.isObject=function(a){return"object"==typeof a},a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},a.deep=function(b,c){for(var d in c){var e=b[d]||{},f=c[d],g=a.isObject(f),h=a.isArray(f);g||h?(g&&!a.isObject(e)&&(b[d]={}),h&&!a.isArray(e)&&(b[d]=[]),b[d]=a.deep(e,f)):b[d]=f}return b},a}(),b=function(a){var b=function(a){this.seperator=a||"."};return b.prototype.get=function(a,b){var c;return this._loop(a,b,{last:function(a,b,d){c=a[b[d]]},missing:function(){return!1}}),c},b.prototype.set=function(b,c,d,e){return this._loop(b,c,{last:function(b,c,f){var g=b[c[f]];return b[c[f]]="object"==typeof g&&e?a.deep(g,d):d},missing:function(a,b,c){a[b[c]]={}}}),d},b.prototype.remove=function(a,b){var c=b.lastIndexOf(":"),d=b,e=a;c>0&&(e=this.get(a,b.slice(0,c)),d=b.slice(c+1)),delete e[d]},b.prototype._loop=function(a,b,c){for(var d=b.split(this.seperator),e=0,f=d.length;f>e;e++){if(f===e+1)return void c.last(a,d,e);if(!a[d[e]]&&c.missing(a,d,e)===!1)return void 0;a=a[d[e]]}},b}(a),c=function(a){var b=new a(":");return{clone:function(a){return JSON.parse(JSON.stringify(a))},extend:function(a,c){for(var d in c)b.set(a,d,c[d],!0);return a},get:function(a,c){return b.get(a,c)},set:function(a,c,d,e){return b.set(a,c,d,e)},remove:function(a,c){return b.remove(a,c)}}}(b),d=function(a,b){var c=a[b];return delete a[b],c},e=function(a,b){var c={clone:a.clone,snip:b};return c.merge=function(a,b){for(var c in b)a[c]=b[c];return a},c.isUndefined=function(a){return"undefined"==typeof a},c.isNull=function(a){return null===a},c}(c,d),f=function(a){var b=function(b){this.original=a.extend({},b),this.reset()};return b.prototype.add=function(b,c){return c?a.set(this.data,b,c):a.extend(this.data,b),this},b.prototype.remove=function(b){a.remove(this.data,b)},b.prototype.reset=function(){this.data=a.clone(this.original)},b}(c),g=function(a){return a.data&&(a.data=JSON.stringify(a.data)),a},h=function(a,b,c){var d=function(c,d){d=a.clone(d),this.ajax=c,this.resources=new b(a.snip(d,"resources")),this.store=new b({client_id:a.snip(d,"client_id"),client_secret:a.snip(d,"client_secret")}),this.defaults=new b(d)};return d.prototype.options=function(){return this._options.apply(this,arguments)},d.prototype.request=function(b,c,d){d=a.clone(d);var e=this._options(b,c,a.snip(d,"data"));return this.ajax(a.merge(e,d))},d.prototype._options=function(a,d,e){var f=this._getResource(d),g=this._getEndpoint(d,f,a),h=g.params;e=e||{},this._hasRequired(h,e),this._isValid(h,e);var i=new b(this.defaults.data),j=i.data.url+d,k=this["_auth"+g.authorization]();return i.add("url",j),i.add("type",a),i.add("data",e),i.add("headers",g.headers),i.add("headers:Authorization",k),c(i.data)},d.prototype._getResource=function(a){var b=this.resources.data[a];if(!b)throw new ReferenceError("No resource exists at `"+a+"`.");return b},d.prototype._getEndpoint=function(a,b,c){var d=b.options[c];if(!d)throw new ReferenceError("Resource `"+a+"` does not have a `"+c+"` endpoint.");return d},d.prototype._hasRequired=function(b,c){for(var d in b){var e=c[d];if(b[d]&&(a.isUndefined(e)||a.isNull(e)))throw new Error("Required param `"+d+"` missing.")}},d.prototype._isValid=function(b,c){for(var d in c)if(a.isUndefined(b[d]))throw new Error("The endpoint does not accept the key: `"+d+"`")},d.prototype._authBasic=function(){var a=this.store.data.client_id,b=this.store.data.client_secret,c=window.btoa(a+":"+b);return"Basic "+c},d.prototype._authBearer=function(){var a=this.store.data.access_token;return"Bearer "+a},d}(e,f,g)});